#!/bin/bash

echo "ğŸš€ Iniciando a instalaÃ§Ã£o do KDE Plasma 6 mÃ­nimo no Arch Linux..."

# Atualizar o sistema antes de instalar qualquer coisa
sudo pacman -Syu --noconfirm

# 1ï¸âƒ£ Remover systemd-boot (se estiver instalado)
if [ -d /boot/loader ]; then
    echo "âŒ Removendo systemd-boot..."
    sudo bootctl remove
    sudo rm -rf /boot/loader /boot/EFI/systemd
fi

# 2ï¸âƒ£ Instalar e configurar o GRUB 2
echo "ğŸ›  Instalando e configurando GRUB 2..."
sudo pacman -S --noconfirm grub efibootmgr
sudo grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB
sudo grub-mkconfig -o /boot/grub/grub.cfg

# 3ï¸âƒ£ Instalar Kernel Zen primeiro
echo "ğŸ–¥ Instalando Kernel Zen..."
sudo pacman -S --noconfirm linux-zen linux-zen-headers

# 4ï¸âƒ£ Instalar KDE Plasma 6 mÃ­nimo
echo "ğŸ¨ Instalando KDE Plasma 6 mÃ­nimo..."
sudo pacman -S --noconfirm plasma-desktop systemsettings kwin

# 5ï¸âƒ£ Instalar gerenciador de login (SDDM)
echo "ğŸ”‘ Instalando e ativando SDDM..."
sudo pacman -S --noconfirm sddm
sudo systemctl enable sddm

# 6ï¸âƒ£ Instalar suporte a Wayland e X11 (XWayland Satellite)
echo "ğŸ–¥ Adicionando suporte a Wayland e XWayland..."
sudo pacman -S --noconfirm qt6-wayland xwayland-satellite

# 7ï¸âƒ£ Instalar bibliotecas multimÃ­dia (GStreamer completo, ALSA, PulseAudio, etc.)
echo "ğŸµ Instalando bibliotecas multimÃ­dia..."
sudo pacman -S --noconfirm gstreamer gst-plugins-base gst-plugins-good gst-plugins-bad gst-plugins-ugly \
    gst-libav gst-plugin-pipewire \
    lib32-gstreamer lib32-gst-plugins-base lib32-gst-plugins-good lib32-gst-plugins-bad lib32-gst-plugins-ugly \
    lib32-gst-libav lib32-libpulse lib32-alsa-plugins lib32-alsa-lib libidn11 lib32-libidn11

# 8ï¸âƒ£ Instalar navegadores e aplicativos essenciais
echo "ğŸŒ Instalando navegadores e aplicativos..."
sudo pacman -S --noconfirm firefox falkon gimp steam

# 9ï¸âƒ£ Atualizar GRUB apÃ³s todas as mudanÃ§as
echo "ğŸ”„ Atualizando GRUB..."
sudo grub-mkconfig -o /boot/grub/grub.cfg

echo "âœ… InstalaÃ§Ã£o concluÃ­da! Reinicie o sistema e selecione o Kernel Zen no boot para melhor desempenho."
